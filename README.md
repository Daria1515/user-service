# User Service

REST API —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π Swagger, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π HATEOAS.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- HATEOAS (Hypermedia as the Engine of Application State)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- H2 in-memory –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Kafka –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 17+
- Maven 3.6+

### –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞

1. **–ß–µ—Ä–µ–∑ Maven:**
   ```bash
   mvn spring-boot:run
   ```

2. **–ß–µ—Ä–µ–∑ batch —Ñ–∞–π–ª (Windows):**
   ```bash
   run.bat
   ```

3. **–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ JAR:**
   ```bash
   mvn clean package
   java -jar target/user-service-1.0-SNAPSHOT.jar
   ```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É **8090**.

### API Endpoints

- **GET** `/api/users` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **GET** `/api/users/{id}` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- **POST** `/api/users` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **PUT** `/api/users/{id}` - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **DELETE** `/api/users/{id}` - –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### Swagger UI

- **Swagger UI:** http://localhost:8090/swagger-ui.html
- **OpenAPI JSON:** http://localhost:8090/api-docs

### H2 Console

- **H2 Console:** http://localhost:8090/h2-console
- **JDBC URL:** `jdbc:h2:mem:testdb`
- **Username:** `sa`
- **Password:** `password`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
curl -X POST http://localhost:8090/api/users \
  -H "Content-Type: application/json" \
  -d @test-user.json
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è PowerShell:

```powershell
Invoke-RestMethod -Uri "http://localhost:8090/api/users" -Method POST -ContentType "application/json" -InFile "test-user.json"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
curl http://localhost:8090/api/users
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

```bash
curl http://localhost:8090/api/users/1
```

## HATEOAS (Hypermedia as the Engine of Application State)

API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HATEOAS, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å HATEOAS

**GET /api/users/1**
```json
{
  "id": 1,
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@example.com",
  "age": 25,
  "createdAt": "2024-01-15T10:30:00",
  "_links": {
    "self": {
      "href": "http://localhost:8090/api/users/1"
    },
    "users": {
      "href": "http://localhost:8090/api/users"
    },
    "update": {
      "href": "http://localhost:8090/api/users/1"
    },
    "delete": {
      "href": "http://localhost:8090/api/users/1"
    }
  }
}
```

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ API

–ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏ –≤ `_links` –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ API:

- **self** - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–∏–π —Ä–µ—Å—É—Ä—Å
- **users** - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **update** - —Å—Å—ã–ª–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **delete** - —Å—Å—ã–ª–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞–ø—Ä–æ—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π HATEOAS

```bash
curl -H "Accept: application/hal+json" http://localhost:8090/api/users/1
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/main/java/org/example/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ KafkaConfig.java
‚îÇ   ‚îú‚îÄ‚îÄ OpenApiConfig.java
‚îÇ   ‚îî‚îÄ‚îÄ HateoasConfig.java
‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îî‚îÄ‚îÄ UserController.java
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îî‚îÄ‚îÄ UserDto.java
‚îú‚îÄ‚îÄ exception/
‚îÇ   ‚îú‚îÄ‚îÄ GlobalExceptionHandler.java
‚îÇ   ‚îî‚îÄ‚îÄ UserNotFoundException.java
‚îú‚îÄ‚îÄ mapper/
‚îÇ   ‚îî‚îÄ‚îÄ UserMapper.java
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îî‚îÄ‚îÄ User.java
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îî‚îÄ‚îÄ UserRepository.java
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îî‚îÄ‚îÄ UserService.java
‚îî‚îÄ‚îÄ UserServiceApplication.java
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `src/main/resources/application.properties`:

- **–ü–æ—Ä—Ç:** 8090
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** H2 in-memory
- **JPA:** create-drop (—Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** DEBUG –¥–ª—è –ø–∞–∫–µ—Ç–∞ org.example
- **HATEOAS:** HAL JSON –∫–∞–∫ —Ñ–æ—Ä–º–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–æ–º 8090
–ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Java:
```bash
taskkill /f /im java.exe
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –≤ PowerShell
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª JSON –¥–ª—è POST-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤–º–µ—Å—Ç–æ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
mvn clean compile
```

### Swagger UI –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8090/swagger-ui.html

### –û—à–∏–±–∫–∏ 500 –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/application.log`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª JSON –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã

### –ü—Ä–æ–±–ª–µ–º—ã —Å HATEOAS
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Accept —É–∫–∞–∑–∞–Ω `application/hal+json`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ HATEOAS –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `compile.bat` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ `mvn clean install`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã HATEOAS
```bash
# –û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–±–µ–∑ HATEOAS)
curl http://localhost:8090/api/users/1

# –ó–∞–ø—Ä–æ—Å —Å HATEOAS
curl -H "Accept: application/hal+json" http://localhost:8090/api/users/1
```

–í –æ—Ç–≤–µ—Ç–µ —Å HATEOAS –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `_links` —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
mvn test
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
```bash
mvn jacoco:report
```

–û—Ç—á–µ—Ç –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `target/site/jacoco/index.html`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Swagger UI

Swagger UI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API:

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8090/swagger-ui.html
2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π endpoint
3. –ù–∞–∂–º–∏—Ç–µ "Try it out"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ "Execute"
5. –ò–∑—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞

–≠—Ç–æ —Å–∞–º—ã–π —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API!

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ HATEOAS

- üß≠ **–ù–∞–≤–∏–≥–∞—Ü–∏—è** - –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å API –±–µ–∑ –∑–Ω–∞–Ω–∏—è URL
- üîó **–°–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å** - —Ä–µ—Å—É—Ä—Å—ã —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π
- üîÑ **–≠–≤–æ–ª—é—Ü–∏—è** - API –º–æ–∂–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –±–µ–∑ –ª–æ–º–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- üìö **–°–∞–º–æ–æ–ø–∏—Å–∞–Ω–∏–µ** - API —Å–∞–º –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è